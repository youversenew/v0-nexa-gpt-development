{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/KOMPYUTER_01/v0-nexa-gpt-development/app/api/generate-title/route.ts"],"sourcesContent":["import { GoogleGenerativeAI } from \"@google/generative-ai\"\r\n\r\nconst genAI = new GoogleGenerativeAI(process.env.GOOGLE_AI_API_KEY || \"\")\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const { content } = await req.json()\r\n\r\n    // Xavfsizlik sozlamalari (Safety Settings) qo'shildi, \r\n    // aks holda model oddiy matnlarni ham bloklashi mumkin.\r\n    const model = genAI.getGenerativeModel({ \r\n      model: \"gemini-2.0-flash\",\r\n      safetySettings: [\r\n        { category: \"HARM_CATEGORY_HARASSMENT\", threshold: \"BLOCK_NONE\" },\r\n        { category: \"HARM_CATEGORY_HATE_SPEECH\", threshold: \"BLOCK_NONE\" },\r\n        { category: \"HARM_CATEGORY_SEXUALLY_EXPLICIT\", threshold: \"BLOCK_NONE\" },\r\n        { category: \"HARM_CATEGORY_DANGEROUS_CONTENT\", threshold: \"BLOCK_NONE\" },\r\n      ],\r\n    })\r\n\r\n    // Agar content bo'sh bo'lsa, xatolik chiqmasligi uchun tekshiruv\r\n    const safeContent = content ? content.slice(0, 200) : \"New Conversation\"\r\n\r\n    const prompt = `Generate a short, concise title (max 40 characters) for this conversation. Only return the title, nothing else:\\n\\n${safeContent}`\r\n\r\n    const result = await model.generateContent(prompt)\r\n    const title = result.response.text().trim().replace(/['\"]/g, \"\").slice(0, 50)\r\n\r\n    return new Response(JSON.stringify({ title }), {\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    })\r\n  } catch (error) {\r\n    console.error(\"[v0] Title generation error:\", error)\r\n    \r\n    // Fallback title (Xatolik bo'lsa qaytadigan nom)\r\n    const fallbackTitle = \"New Chat\"\r\n    \r\n    return new Response(JSON.stringify({ title: fallbackTitle }), {\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n    })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,QAAQ,IAAI,sLAAkB,CAAC,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AAE/D,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAElC,uDAAuD;QACvD,wDAAwD;QACxD,MAAM,QAAQ,MAAM,kBAAkB,CAAC;YACrC,OAAO;YACP,gBAAgB;gBACd;oBAAE,UAAU;oBAA4B,WAAW;gBAAa;gBAChE;oBAAE,UAAU;oBAA6B,WAAW;gBAAa;gBACjE;oBAAE,UAAU;oBAAmC,WAAW;gBAAa;gBACvE;oBAAE,UAAU;oBAAmC,WAAW;gBAAa;aACxE;QACH;QAEA,iEAAiE;QACjE,MAAM,cAAc,UAAU,QAAQ,KAAK,CAAC,GAAG,OAAO;QAEtD,MAAM,SAAS,CAAC,mHAAmH,EAAE,aAAa;QAElJ,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,QAAQ,OAAO,QAAQ,CAAC,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC,SAAS,IAAI,KAAK,CAAC,GAAG;QAE1E,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE;QAAM,IAAI;YAC7C,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gCAAgC;QAE9C,iDAAiD;QACjD,MAAM,gBAAgB;QAEtB,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,OAAO;QAAc,IAAI;YAC5D,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;IACF;AACF"}}]
}