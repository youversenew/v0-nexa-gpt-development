{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\r\nimport { type NextRequest, NextResponse } from \"next/server\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY!;\r\n\r\nexport async function updateSession(request: NextRequest) {\r\n  // 1️⃣ Boshlang‘ich response\r\n  let response = NextResponse.next();\r\n\r\n  // 2️⃣ Supabase server client\r\n  const supabase = createServerClient(\r\n    supabaseUrl,\r\n    supabaseKey,\r\n    {\r\n      cookies: {\r\n        getAll() {\r\n          return request.cookies.getAll();\r\n        },\r\n        setAll(cookiesToSet) {\r\n          // ❌ request.cookies.set ishlatilmaydi\r\n          cookiesToSet.forEach(({ name, value, options }) => {\r\n            response.cookies.set(name, value, options);\r\n          });\r\n        },\r\n      },\r\n    }\r\n  );\r\n\r\n  // 3️⃣ Hozirgi foydalanuvchini olish\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser();\r\n\r\n  // 4️⃣ Protected routes\r\n  const protectedPaths = [\"/chat\", \"/settings\", \"/account\"];\r\n  const isProtectedPath = protectedPaths.some((path) =>\r\n    request.nextUrl.pathname.startsWith(path)\r\n  );\r\n\r\n  if (isProtectedPath && !user) {\r\n    const url = request.nextUrl.clone();\r\n    url.pathname = \"/login\";\r\n    return NextResponse.redirect(url);\r\n  }\r\n\r\n  // 5️⃣ Auth pages redirect (login/signup)\r\n  const authPaths = [\"/login\", \"/signup\"];\r\n  const isAuthPath = authPaths.some((path) =>\r\n    request.nextUrl.pathname.startsWith(path)\r\n  );\r\n\r\n  if (isAuthPath && user) {\r\n    const url = request.nextUrl.clone();\r\n    url.pathname = \"/chat\";\r\n    return NextResponse.redirect(url);\r\n  }\r\n\r\n  // 6️⃣ Response’ni return qilamiz (cookies bilan)\r\n  return response;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;;;AAEA,MAAM;AACN,MAAM;AAEC,eAAe,cAAc,OAAoB;IACtD,4BAA4B;IAC5B,IAAI,WAAW,gMAAY,CAAC,IAAI;IAEhC,6BAA6B;IAC7B,MAAM,WAAW,IAAA,uMAAkB,EACjC,aACA,aACA;QACE,SAAS;YACP;gBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;YAC/B;YACA,QAAO,YAAY;gBACjB,sCAAsC;gBACtC,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE;oBAC5C,SAAS,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;gBACpC;YACF;QACF;IACF;IAGF,oCAAoC;IACpC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,uBAAuB;IACvB,MAAM,iBAAiB;QAAC;QAAS;QAAa;KAAW;IACzD,MAAM,kBAAkB,eAAe,IAAI,CAAC,CAAC,OAC3C,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAGtC,IAAI,mBAAmB,CAAC,MAAM;QAC5B,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,yCAAyC;IACzC,MAAM,YAAY;QAAC;QAAU;KAAU;IACvC,MAAM,aAAa,UAAU,IAAI,CAAC,CAAC,OACjC,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;IAGtC,IAAI,cAAc,MAAM;QACtB,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;QACjC,IAAI,QAAQ,GAAG;QACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;IAC/B;IAEA,iDAAiD;IACjD,OAAO;AACT"}}]
}